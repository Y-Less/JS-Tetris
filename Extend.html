<html>
    <head>
    </head>
    <body>
        <canvas id="gameboard" width="1000" height="1500">
            I realise it is non-portable, but this page requires &lt;canvas&gt; and JavaScript, sorry.
        </canvas>
        <script type="text/javascript" src="Extend.js"></script>
        <script type="text/javascript" src="Window.js"></script>
        <script type="text/javascript">
        
        function Every(_ms, _init, _catchup)
        {
            _init    = _init    !== false;
            _catchup = _catchup !== false;
            
            var _cur = 0;
            var ret = function (add)
                {
                    _cur += add;
                    if (_init)
                    {
                        _init = false;
                        return true;
                    }
                    else if (_cur >= _ms)
                    {
                        if (_catchup) _cur -= _ms;
                        else _cur = 0;
                        return true;
                    }
                    return false;
                };
            
            ret.Reset = function ()  { _cur = 0;    };
            ret.Get   = function ()  { return _cur; };
            ret.Add   = function (s) { _cur += s;   };
            
            return ret;
        }
        
        var canvas = document.getElementById('gameboard').getContext('2d');
        
        var Animal = function (a)
        {
            console.log('' + a);
            this.Hi = function () { console.log('Animal.Hi'); }
        }
        Object.specify(Animal, new Interface (['Hi']));
        Animal.prototype.Yo = function () { console.log('Animal.Yo'); }
        
            /*new Interface ({
                Hi: Interface.FUNCTION,
                VARR: Interface.VAR,
                YEAH: Interface.CONST
            }));*/
        
        var Cat = Object.inherit(Animal, function (x)
            {
                console.log('a');
                this.super(x);
                console.log('b');
            });
        
        Cat.prototype.Hi = function () { console.log('Cat.Hi'); }
        
        var aa = new Cat(44);
        var bb = new Animal(45);
        
        aa.Yo();
        aa.Hi();
        bb.Yo();
        bb.Hi();
        //Animal.prototype.Hi.apply(aa);
        //Cat.base.Hi.apply(aa);
        var b = Cat.VARR;
        var c = Cat.YEAH;
        
        
        function ASSERT(x) { if (x) console.log('PASS'); else console.log('FAIL'); }
        
        function Square(_parent, _x, _y, _colour)
        {
            var _last = Every(1000);
            
            this.super(_parent, _x, _y);
            
            this.Render = function (ctx, time, force)
            {
                if (_last(time) || force) // Order is important.
                {
                    var gradient = ctx.createLinearGradient(0, 0, ctx.width, 0);
                    // Add the colors with fixed stops at 1/4 of the width.
                    gradient.addColorStop(0.0 , 'magenta');
                    gradient.addColorStop(0.25, 'blue');
                    gradient.addColorStop(0.50, 'green');
                    gradient.addColorStop(0.75, 'yellow');
                    gradient.addColorStop(1.0 , 'red');
                    
                    // Use the gradient.
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, ctx.width / 2, ctx.height / 2);
                    ctx.fillRect(ctx.width / 2, ctx.height / 2, ctx.width / 2, ctx.height / 2);
                    //ctx.fillRect(250, 300, 600, 500);
                    //ctx.fillStyle = 'skyblue';
                    //ctx.fillRect(0, 0, ctx.width, ctx.height);
                    _last = time;
                    return true;
                }
                return false;
            };
            return this;
        }
        
        
        Object.inherit(Widget, Square);
        
        
        //w = new Widget(0, -10, -10);
        w = new Square(0, -10, -10);
        ASSERT(w.X == -10);
        ASSERT(w.Y == -10);
        w.Width = 600;
        w.Height = 600;
        //console.log('1');
        ASSERT(w.Width == 600);
        //console.log('1');
        ASSERT(w.Height == 600);
        
        //<!-- w._Render(canvas, 10, 10, 20, 20, 60, 60, 10000, true); -->
        x = new Square(w, 750, 750);
        x.Width = 250;
        x.Height = 250;
        
        w._Render(canvas, 10, 10, 0, 0, 400, 400, 10000, true);
        
        
        </script>
    </body>
</html>

