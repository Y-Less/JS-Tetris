<html>
	<head>
		<title>Tetris, by Y_Less.</title>
        <style type="text/css">
            
            body, html, canvas, .canvas_container
            {
                border: 0;
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
            
            body
            {
                width: 100%;
                height: 100%;
            }
            
            canvas, .canvas_container
            {
                display: block;
                position: absolute;
                visibility: shown;
            }
            
            *
            {
                -moz-user-select: none;
                -webkit-user-select: none;
                -ms-user-select:none;
                user-select:none;
            }
            
        </style>
	</head>
	<body>
        <!-- <canvas id="tetrisSurface"></canvas> -->
		<!-- <script type="text/javascript" src="Tetris.js"></script> -->
		<script type="text/javascript" src="Utils.js"></script>
		<script type="text/javascript" src="States.js"></script>
		<script type="text/javascript" src="View.js"></script>
		<script type="text/javascript" src="Controller.js"></script>
		<script type="text/javascript">
        
        var BLOCK_SIZE = 30;
        
        var STATE_SPLASH   = 'SplashScreen';
        var STATE_CONTINUE = 'ContinueScreen';
        var STATE_MENU     = 'Menu';
        var STATE_CREDITS  = 'Credits';
        var STATE_OPTIONS  = 'Options';
        var STATE_SCORES   = 'HighScores';
        var STATE_NEW      = 'NewGame';
        var STATE_GAME     = 'Game';
        var STATE_PAUSE    = 'Pause';
        var STATE_QUIT     = 'Quit';
        var STATE_OVER     = 'GameOver';
        var STATE_HIGH     = 'HighScore';
        var STATE_INDUCTED = 'Inducted';
        
        var StateMachine = new StateHandler(STATE_SPLASH);
        
        </script>
        <!-- Views -->
		<script type="text/javascript" src="Background/Controller.js"></script>
		<script type="text/javascript" src="Background/View.js"></script>
		<script type="text/javascript" src="Menu/Controller.js"></script>
		<script type="text/javascript" src="Menu/View.js"></script>
		<!-- <script type="text/javascript" src="Menu/View.js"></script> -->
        <script type="text/javascript">
        
        var Test = function (y)
        {
            var _x = y;
            Object.defineProperty(this, "x", {
                    get: function () { return _x; },
                    set: ReadOnly('x'),
                });
            return this;
        }
        var T2 = new Test(88);
        
        window.requestAnimFrame = (function ()
            {
                return window.requestAnimationFrame    ||
                    window.webkitRequestAnimationFrame ||
                    window.mozRequestAnimationFrame    ||
                    function (callback)
                    {
                        window.setTimeout(callback, 1000 / 60);
                    };
            })();
        
        window.onload = function()
        {
            /*var GLOBAL_CANVAS  = document.getElementById('tetrisSurface');
            var GLOBAL_CONTEXT = GLOBAL_CANVAS.getContext('2d');*/
            
            StateMachine.Start();
            var Screen = Background.View;
            
            function ResizeCanvas()
            {
                Screen.Resize();
            }
            
            window.addEventListener('resize', ResizeCanvas, false);
            //ResizeCanvas();
            
            //Background.Init();
            //Background.Show();
            //Menu.View.Show();
            
            (function ()
            {
                var _lastRender = Date.now();
                var _lastUpdate = Date.now();
                
                function AnimLoop()
                {
                    requestAnimFrame(AnimLoop);
                    var last = _lastRender;
                    _lastRender = Date.now();
                    Screen._Render(_lastRender - last);
                }
                
                function UpdateLoop()
                {
                    var last = _lastUpdate;
                    _lastUpdate = Date.now();
                    //Background.View.Update(_lastUpdate - last);
                    StateMachine.Update(_lastUpdate - last);
                }
                
                AnimLoop();
                window.setInterval(UpdateLoop, 50);
            })();
            
            //StateMachine.
            
            //Background._Render(100);
            
            //window.setInterval(function () { Background._Render(100); }, 1000);
            
        };
        
        </script>
	</body>
</html>


